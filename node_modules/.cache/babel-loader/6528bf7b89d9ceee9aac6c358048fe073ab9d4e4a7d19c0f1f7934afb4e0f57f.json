{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ID3v24TagMapper = void 0;\nconst GenericTagMapper_1 = require(\"../common/GenericTagMapper\");\nconst CaseInsensitiveTagMap_1 = require(\"../common/CaseInsensitiveTagMap\");\nconst util = require(\"../common/Util\");\n/**\n * ID3v2.3/ID3v2.4 tag mappings\n */\nconst id3v24TagMap = {\n  // id3v2.3\n  TIT2: 'title',\n  TPE1: 'artist',\n  'TXXX:Artists': 'artists',\n  TPE2: 'albumartist',\n  TALB: 'album',\n  TDRV: 'date',\n  /**\n   * Original release year\n   */\n  TORY: 'originalyear',\n  TPOS: 'disk',\n  TCON: 'genre',\n  APIC: 'picture',\n  TCOM: 'composer',\n  'USLT:description': 'lyrics',\n  TSOA: 'albumsort',\n  TSOT: 'titlesort',\n  TOAL: 'originalalbum',\n  TSOP: 'artistsort',\n  TSO2: 'albumartistsort',\n  TSOC: 'composersort',\n  TEXT: 'lyricist',\n  'TXXX:Writer': 'writer',\n  TPE3: 'conductor',\n  // 'IPLS:instrument': 'performer:instrument', // ToDo\n  TPE4: 'remixer',\n  'IPLS:arranger': 'arranger',\n  'IPLS:engineer': 'engineer',\n  'IPLS:producer': 'producer',\n  'IPLS:DJ-mix': 'djmixer',\n  'IPLS:mix': 'mixer',\n  TPUB: 'label',\n  TIT1: 'grouping',\n  TIT3: 'subtitle',\n  TRCK: 'track',\n  TCMP: 'compilation',\n  POPM: 'rating',\n  TBPM: 'bpm',\n  TMED: 'media',\n  'TXXX:CATALOGNUMBER': 'catalognumber',\n  'TXXX:MusicBrainz Album Status': 'releasestatus',\n  'TXXX:MusicBrainz Album Type': 'releasetype',\n  /**\n   * Release country as documented: https://picard.musicbrainz.org/docs/mappings/#cite_note-0\n   */\n  'TXXX:MusicBrainz Album Release Country': 'releasecountry',\n  /**\n   * Release country as implemented // ToDo: report\n   */\n  'TXXX:RELEASECOUNTRY': 'releasecountry',\n  'TXXX:SCRIPT': 'script',\n  TLAN: 'language',\n  TCOP: 'copyright',\n  WCOP: 'license',\n  TENC: 'encodedby',\n  TSSE: 'encodersettings',\n  'TXXX:BARCODE': 'barcode',\n  'TXXX:ISRC': 'isrc',\n  TSRC: 'isrc',\n  'TXXX:ASIN': 'asin',\n  'TXXX:originalyear': 'originalyear',\n  'UFID:http://musicbrainz.org': 'musicbrainz_recordingid',\n  'TXXX:MusicBrainz Release Track Id': 'musicbrainz_trackid',\n  'TXXX:MusicBrainz Album Id': 'musicbrainz_albumid',\n  'TXXX:MusicBrainz Artist Id': 'musicbrainz_artistid',\n  'TXXX:MusicBrainz Album Artist Id': 'musicbrainz_albumartistid',\n  'TXXX:MusicBrainz Release Group Id': 'musicbrainz_releasegroupid',\n  'TXXX:MusicBrainz Work Id': 'musicbrainz_workid',\n  'TXXX:MusicBrainz TRM Id': 'musicbrainz_trmid',\n  'TXXX:MusicBrainz Disc Id': 'musicbrainz_discid',\n  'TXXX:ACOUSTID_ID': 'acoustid_id',\n  'TXXX:Acoustid Id': 'acoustid_id',\n  'TXXX:Acoustid Fingerprint': 'acoustid_fingerprint',\n  'TXXX:MusicIP PUID': 'musicip_puid',\n  'TXXX:MusicMagic Fingerprint': 'musicip_fingerprint',\n  WOAR: 'website',\n  // id3v2.4\n  // ToDo: In same sequence as defined at http://id3.org/id3v2.4.0-frames\n  TDRC: 'date',\n  TYER: 'year',\n  TDOR: 'originaldate',\n  // 'TMCL:instrument': 'performer:instrument',\n  'TIPL:arranger': 'arranger',\n  'TIPL:engineer': 'engineer',\n  'TIPL:producer': 'producer',\n  'TIPL:DJ-mix': 'djmixer',\n  'TIPL:mix': 'mixer',\n  TMOO: 'mood',\n  // additional mappings:\n  SYLT: 'lyrics',\n  TSST: 'discsubtitle',\n  TKEY: 'key',\n  COMM: 'comment',\n  TOPE: 'originalartist',\n  // Windows Media Player\n  'PRIV:AverageLevel': 'averageLevel',\n  'PRIV:PeakLevel': 'peakLevel',\n  // Discogs\n  'TXXX:DISCOGS_ARTIST_ID': 'discogs_artist_id',\n  'TXXX:DISCOGS_ARTISTS': 'artists',\n  'TXXX:DISCOGS_ARTIST_NAME': 'artists',\n  'TXXX:DISCOGS_ALBUM_ARTISTS': 'albumartist',\n  'TXXX:DISCOGS_CATALOG': 'catalognumber',\n  'TXXX:DISCOGS_COUNTRY': 'releasecountry',\n  'TXXX:DISCOGS_DATE': 'originaldate',\n  'TXXX:DISCOGS_LABEL': 'label',\n  'TXXX:DISCOGS_LABEL_ID': 'discogs_label_id',\n  'TXXX:DISCOGS_MASTER_RELEASE_ID': 'discogs_master_release_id',\n  'TXXX:DISCOGS_RATING': 'discogs_rating',\n  'TXXX:DISCOGS_RELEASED': 'date',\n  'TXXX:DISCOGS_RELEASE_ID': 'discogs_release_id',\n  'TXXX:DISCOGS_VOTES': 'discogs_votes',\n  'TXXX:CATALOGID': 'catalognumber',\n  'TXXX:STYLE': 'genre',\n  'TXXX:REPLAYGAIN_TRACK_PEAK': 'replaygain_track_peak',\n  'TXXX:REPLAYGAIN_TRACK_GAIN': 'replaygain_track_gain',\n  'TXXX:REPLAYGAIN_ALBUM_PEAK': 'replaygain_album_peak',\n  'TXXX:REPLAYGAIN_ALBUM_GAIN': 'replaygain_album_gain',\n  'TXXX:MP3GAIN_MINMAX': 'replaygain_track_minmax',\n  'TXXX:MP3GAIN_ALBUM_MINMAX': 'replaygain_album_minmax',\n  'TXXX:MP3GAIN_UNDO': 'replaygain_undo',\n  MVNM: 'movement',\n  MVIN: 'movementIndex',\n  PCST: 'podcast',\n  TCAT: 'category',\n  TDES: 'description',\n  TDRL: 'date',\n  TGID: 'podcastId',\n  TKWD: 'keywords',\n  WFED: 'podcasturl'\n};\nclass ID3v24TagMapper extends CaseInsensitiveTagMap_1.CaseInsensitiveTagMap {\n  static toRating(popm) {\n    return {\n      source: popm.email,\n      rating: popm.rating > 0 ? (popm.rating - 1) / 254 * GenericTagMapper_1.CommonTagMapper.maxRatingScore : undefined\n    };\n  }\n  constructor() {\n    super(['ID3v2.3', 'ID3v2.4'], id3v24TagMap);\n  }\n  /**\n   * Handle post mapping exceptions / correction\n   * @param tag to post map\n   * @param warnings Wil be used to register (collect) warnings\n   * @return Common value e.g. \"Buena Vista Social Club\"\n   */\n  postMap(tag, warnings) {\n    switch (tag.id) {\n      case 'UFID':\n        // decode MusicBrainz Recording Id\n        if (tag.value.owner_identifier === 'http://musicbrainz.org') {\n          tag.id += ':' + tag.value.owner_identifier;\n          tag.value = util.decodeString(tag.value.identifier, 'latin1'); // latin1 == iso-8859-1\n        }\n        break;\n      case 'PRIV':\n        switch (tag.value.owner_identifier) {\n          // decode Windows Media Player\n          case 'AverageLevel':\n          case 'PeakValue':\n            tag.id += ':' + tag.value.owner_identifier;\n            tag.value = tag.value.data.length === 4 ? tag.value.data.readUInt32LE(0) : null;\n            if (tag.value === null) {\n              warnings.addWarning(`Failed to parse PRIV:PeakValue`);\n            }\n            break;\n          default:\n            warnings.addWarning(`Unknown PRIV owner-identifier: ${tag.value.owner_identifier}`);\n        }\n        break;\n      case 'COMM':\n        tag.value = tag.value ? tag.value.text : null;\n        break;\n      case 'POPM':\n        tag.value = ID3v24TagMapper.toRating(tag.value);\n        break;\n      default:\n        break;\n    }\n  }\n}\nexports.ID3v24TagMapper = ID3v24TagMapper;\n//# sourceMappingURL=ID3v24TagMapper.js.map","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}