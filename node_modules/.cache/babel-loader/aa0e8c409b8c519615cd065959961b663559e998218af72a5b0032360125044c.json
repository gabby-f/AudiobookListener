{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BitReader = void 0;\nconst Token = require(\"token-types\");\nclass BitReader {\n  constructor(tokenizer) {\n    this.tokenizer = tokenizer;\n    this.pos = 0;\n    this.dword = undefined;\n  }\n  /**\n   *\n   * @param bits 1..30 bits\n   */\n  async read(bits) {\n    while (this.dword === undefined) {\n      this.dword = await this.tokenizer.readToken(Token.UINT32_LE);\n    }\n    let out = this.dword;\n    this.pos += bits;\n    if (this.pos < 32) {\n      out >>>= 32 - this.pos;\n      return out & (1 << bits) - 1;\n    } else {\n      this.pos -= 32;\n      if (this.pos === 0) {\n        this.dword = undefined;\n        return out & (1 << bits) - 1;\n      } else {\n        this.dword = await this.tokenizer.readToken(Token.UINT32_LE);\n        if (this.pos) {\n          out <<= this.pos;\n          out |= this.dword >>> 32 - this.pos;\n        }\n        return out & (1 << bits) - 1;\n      }\n    }\n  }\n  async ignore(bits) {\n    if (this.pos > 0) {\n      const remaining = 32 - this.pos;\n      this.dword = undefined;\n      bits -= remaining;\n      this.pos = 0;\n    }\n    const remainder = bits % 32;\n    const numOfWords = (bits - remainder) / 32;\n    await this.tokenizer.ignore(numOfWords * 4);\n    return this.read(remainder);\n  }\n}\nexports.BitReader = BitReader;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}